<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  
  <meta name="description"
    content="岁月总是历久弥新，需要细细品尝。" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" />
  <!-- Highlight.js theme (swapped dynamically for dark mode) -->
  <link id="hljs-theme" rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/a11y-light.min.css" />
  <link rel="stylesheet" href="/main.css" />
  
  <title>2019 Android library 怎么快速上传 Jcenter</title>
  <script src="/theme.js" defer></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQQBL084VX" />
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-TQQBL084VX");
  </script>
</head>

<body>
  <div id="container-main">
    <main>
      <div class="wrap">
        <article>
          
<div id="content">
  <h1 id="2019-android-library-zen-me-kuai-su-shang-chuan-jcenter">2019 Android library 怎么快速上传 Jcenter</h1>
<h2 id="library-de-liang-chong-jie-gou">Library 的两种结构</h2>
<p>当我们写下自己的组件库时，结构可能如下面两种方式：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcf267ef65cf75~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>当我们的库比较简单时采用第一种方式就足够了，但是当库比较复杂时，第二种拆分为多个组件的方式能够跟好的组织与提供服务。下面会介绍这两种结构的项目如何快速上传 Jcenter。</p>
<h2 id="zhu-ce-bintray">注册 Bintray</h2>
<p>第一步首先是注册 Bintray Open Source 账户，注册地址是
<a href="https://bintray.com/signup/oss">Create Your JFrog Bintray Account</a>
<a href="https://bintray.com/signup/oss">https://bintray.com/signup/oss</a>，
请注意不要去 Bintray 主页注册为企业账户，否则删除账户需要在 3 个月后试用时长过期后才可以申请。</p>
<p>注册页面预览：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dceac6e0197081~tplv-t2oaga2asx-image.image" alt="_" /></p>
<h2 id="jian-li-maven-cang-ku">建立 Maven 仓库</h2>
<p>账号建立并成功登录之后,你们看到的页面可能和下图类似：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dceb2e3ca5ca1a~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>不同之处可能是 Owned Repositories 部分是空的。
接下来就是建立自己的 maven 仓库了。
点击 Owned Repositories 区域的 Add New Repository，
重点在于 Type 需要选择 Maven 项，其他部分根据自己的实际情况填写。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dceb8ee2caf9b0~tplv-t2oaga2asx-image.image" alt="screencapture-bintray-swordsoul-2019-10-15-17_18_24.png" /></p>
<p>当创建成功之后，回自动进入的新的仓库页面，预览如下：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcebc5b386bd27~tplv-t2oaga2asx-image.image" alt="screencapture-bintray-beta-2019-10-15-17_24_04.png" /></p>
<h2 id="dui-dan-module-library-jin-xing-shang-chuan">对单 Module Library 进行上传</h2>
<p>既然仓库以及建立好了接下来就是对 library 将上传到刚刚建立的 maven 仓库了。</p>
<h3 id="xiu-gai-project-build-gradle">修改 Project build.gradle</h3>
<p>首先在 project 下的 build.gradle 脚本添加必要的依赖：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">buildscript {
    dependencies {
        ...
        classpath &#x27;com.jfrog.bintray.gradle:gradle-bintray-plugin:1.8.4&#x27;
        classpath &#x27;com.github.dcendents:android-maven-gradle-plugin:2.1&#x27;
        ...
    }
}
allprojects {
    &#x2F;&#x2F;如果是kotlin项目,请添加此项,纯Java项目请忽略
    tasks.withType(Javadoc).all { enabled = false }
}
</code></pre>
<h3 id="jian-li-bintrayv1-gradle-wen-jian">建立 bintrayv1.gradle 文件</h3>
<p>然后在 project 目录下新建 bintrayv1.gradle 文件，内容如下：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">apply plugin: &#x27;com.jfrog.bintray&#x27;

version = libraryVersion

if (project.hasProperty(&quot;android&quot;)) { &#x2F;&#x2F; Android libraries
    task sourcesJar(type: Jar) {
        classifier = &#x27;sources&#x27;
        from android.sourceSets.main.java.srcDirs
    }

    task javadoc(type: Javadoc) {
        source = android.sourceSets.main.java.srcDirs
        classpath += project.files(android.getBootClasspath().join(File.pathSeparator))
    }
} else { &#x2F;&#x2F; Java libraries
    task sourcesJar(type: Jar, dependsOn: classes) {
        classifier = &#x27;sources&#x27;
        from sourceSets.main.allSource
    }
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = &#x27;javadoc&#x27;
    from javadoc.destinationDir
}

artifacts {
    archives javadocJar
    archives sourcesJar
}

&#x2F;&#x2F; Bintray
Properties properties = new Properties()
properties.load(project.rootProject.file(&#x27;local.properties&#x27;).newDataInputStream())

bintray {
    user = properties.getProperty(&quot;bintray.user&quot;)
    key = properties.getProperty(&quot;bintray.apikey&quot;)

    configurations = [&#x27;archives&#x27;]
    pkg {
        repo = bintrayRepo
        name = bintrayName
        desc = libraryDescription
        websiteUrl = siteUrl
        vcsUrl = gitUrl
        licenses = allLicenses
        publish = true
        publicDownloadNumbers = true
        version {
            desc = libraryDescription
            gpg {
                sign = true &#x2F;&#x2F;Determines whether to GPG sign the files. The default is false
                passphrase = properties.getProperty(&quot;bintray.gpg.password&quot;)
                &#x2F;&#x2F;Optional. The passphrase for GPG signing&#x27;
            }
        }
    }
}
</code></pre>
<h3 id="jian-li-installv1-gradle-wen-jian">建立 installv1.gradle 文件</h3>
<p>之后在 project 目录下再新建 installv1.gradle 文件，内容如下：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">apply plugin: &#x27;com.github.dcendents.android-maven&#x27;

group = publishedGroupId                               &#x2F;&#x2F; Maven Group ID for the artifact

install {
    repositories.mavenInstaller {
        &#x2F;&#x2F; This generates POM.xml with proper parameters
        pom {
            project {
                packaging &#x27;aar&#x27;
                groupId publishedGroupId
                artifactId artifact

                &#x2F;&#x2F; Add your description here
                name libraryName
                description libraryDescription
                url siteUrl

                &#x2F;&#x2F; Set your license
                licenses {
                    license {
                        name licenseName
                        url licenseUrl
                    }
                }
                developers {
                    developer {
                        id developerId
                        name developerName
                        email developerEmail
                    }
                }
                scm {
                    connection gitUrl
                    developerConnection gitUrl
                    url siteUrl

                }
            }
        }
    }
}
</code></pre>
<p>这里解释一下为什么要新建这两个文件，这两个文件是 Bintray 为了方便上传 library 所编写的脚本，源文件位于 github，为了避免 gradle 同步过程中由网络引发的错误，所以直接将其内置与项目中。源地址分别是：</p>
<ul>
<li><a href="https://raw.githubusercontent.com/nuuneoi/JCenter/master/installv1.gradle">installv1.gradle</a></li>
<li><a href="https://raw.githubusercontent.com/nuuneoi/JCenter/master/bintrayv1.gradle">bintrayv1.gradle</a></li>
</ul>
<p>若嫌麻烦，也可在后续引用到改文件的地方直接填入 http 链接，不必新建为本地文件。</p>
<h3 id="tian-xie-publish-xin-xi">填写 Publish 信息</h3>
<p>在需要上传的 module 下建立 publish.gradle 文件，填写内容如下：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">ext {
    &#x2F;&#x2F; 此处填写刚才建立的maven仓库的仓库名称
    bintrayRepo = &#x27;YourRepositoryName&#x27;
    &#x2F;&#x2F; library的group id
    publishedGroupId = &#x27;com.xxx.libraryName&#x27;
    &#x2F;&#x2F; library网站地址
    siteUrl = &#x27;&#x27;
    &#x2F;&#x2F; library仓库地址
    gitUrl = &#x27;&#x27;

    &#x2F;&#x2F; 注册时候的bintray username
    developerId = &#x27;&#x27;
    &#x2F;&#x2F; 开发者名称
    developerName = &#x27;&#x27;
    &#x2F;&#x2F; 开发者邮箱
    developerEmail = &#x27;&#x27;

    &#x2F;&#x2F; 开源许可证（这里是Apache 2.0）
    licenseName = &#x27;The Apache Software License, Version 2.0&#x27;
    licenseUrl = &#x27;http:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0.txt&#x27;
    allLicenses = [&quot;Apache-2.0&quot;]

    &#x2F;&#x2F; library artifact（单个module一般就填写library name）
    artifact = &#x27;libraryName&#x27;
    libraryName = &#x27;&#x27;
    libraryVersion = &#x27;&#x27;
    libraryDescription = &#x27;&#x27;
    &#x2F;&#x2F; bintrayName 是你在网页Repository页面能看到的名称
    bintrayName = &#x27;libraryName-&#x27; + artifact
}

apply from: &#x27;..&#x2F;installv1.gradle&#x27;
apply from: &#x27;..&#x2F;bintrayv1.gradle&#x27;
</code></pre>
<h3 id="xiu-gai-module-build-gradle-wen-jian">修改 Module build.gradle 文件</h3>
<p>只需要在需要上传的 module 目录下的 build.gradle 文件的最后添加以下代码：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">apply from: &#x27;publish.gradle&#x27;
</code></pre>
<h3 id="bian-ji-local-properties-wen-jian">编辑 local.properties 文件</h3>
<p>在 bintray 个人页面右上角头像处，点击 Edit Profile 进入个人信息编辑页面后，点击左下角的 API Key，
会提示输入密码，输入密码后点击 Copy To Clipboard 就可以得到你自己的 bintray api key。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcee4ce83e0a1e~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>然后修改 project 目录下的 local.properties 文件，在末尾添加下面的内容。</p>
<pre data-lang="txt" class="language-txt "><code class="language-txt" data-lang="txt">bintray.user=你的bintray username
bintray.apikey=刚才复制的bintray api key
</code></pre>
<p>在获取到 bintray api key 之后就可以进行上传了。</p>
<h2 id="dui-duo-module-library-jin-xing-shang-chuan">对多 Module Library 进行上传</h2>
<p>如果只是单 Module 可以跳过此部分。</p>
<p>由于多 Module library 对于每个 module 而言，同属与同一个 library，所以 publish 信息中大部分信息相同，所以便把这些相同的信息提取出来。</p>
<h3 id="jian-li-publish-info-gradle-wen-jian">建立 publish_info.gradle 文件</h3>
<p>我们选择把相同的信息提取到 Project 目录下到 publish_info.gradle 文件中，内容如下：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">ext {
    &#x2F;&#x2F; 此处填写刚才建立的maven仓库的仓库名称
    bintrayRepo = &#x27;YourRepositoryName&#x27;
    &#x2F;&#x2F; library的group id
    publishedGroupId = &#x27;com.xxx.libraryName&#x27;
    &#x2F;&#x2F; library网站地址
    siteUrl = &#x27;&#x27;
    &#x2F;&#x2F; library仓库地址
    gitUrl = &#x27;&#x27;

    &#x2F;&#x2F; 注册时候的bintray username
    developerId = &#x27;&#x27;
    &#x2F;&#x2F; 开发者名称
    developerName = &#x27;&#x27;
    &#x2F;&#x2F; 开发者邮箱
    developerEmail = &#x27;&#x27;

    &#x2F;&#x2F; 开源许可证（这里是Apache 2.0）
    licenseName = &#x27;The Apache Software License, Version 2.0&#x27;
    licenseUrl = &#x27;http:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0.txt&#x27;
    allLicenses = [&quot;Apache-2.0&quot;]
}
</code></pre>
<h3 id="tian-xie-publish-xin-xi-1">填写 publish 信息</h3>
<p>在每个 module 目录下建立 publish.gradle 文件，内容如下：</p>
<pre data-lang="groovy" class="language-groovy "><code class="language-groovy" data-lang="groovy">ext {
    &#x2F;&#x2F; library artifact（单个module一般就填写library name）
    artifact = &#x27;libraryName&#x27;
    libraryName = &#x27;&#x27;
    libraryVersion = &#x27;&#x27;
    libraryDescription = &#x27;&#x27;
    &#x2F;&#x2F; bintrayName 是你在网页Repository页面能看到的名称
    bintrayName = &#x27;libraryName-&#x27; + artifact
}

apply from: &#x27;..&#x2F;publish_info.gradle&#x27;
apply from: &#x27;..&#x2F;installv1.gradle&#x27;
apply from: &#x27;..&#x2F;bintrayv1.gradle&#x27;
</code></pre>
<p>其余步骤均与单个 module 上传部分相同。</p>
<h2 id="shang-chuan">上传</h2>
<p>上传有两种方式：</p>
<ul>
<li>
<p>命令行：
打开终端，在 project 目录下运行如下命令即可（modelName 改为自己需要上传的 module 名称）：</p>
<pre data-lang="shell" class="language-shell "><code class="language-shell" data-lang="shell">.&#x2F;gradlew moduleName:bU
</code></pre>
</li>
<li>
<p>IDE 可视化：</p>
<p>选择侧边栏中的 gradle，然后导航至需要上传的 module 下，打开 Tasks/publishing/bintrayUpload，双击执行任务即可。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcefb6e09133de~tplv-t2oaga2asx-image.image" alt="_" /></p>
</li>
</ul>
<p>上传成功后截图：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcef836da74ddf~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcef9a828b9f93~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcefa529e4fd61~tplv-t2oaga2asx-image.image" alt="_" /></p>
<h2 id="tian-jia-zhi-jcenter">添加至 Jcenter</h2>
<p>新版 Bintray 网站改版之后 Add to Jcenter 被放置在了 Actions 按钮下。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcefea0053a2bb~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>点击 Add to Jcenter 按钮后，此时会弹出如下弹窗：
在填写相关信息后，点击 Send，等待申请通过后，你的仓库便会被同步到 Jcenter。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcf022c151d563~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>当申请通过后，你会在网站的 Inbox 收到如下信息：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/15/16dcf04d55f720e7~tplv-t2oaga2asx-image.image" alt="_" /></p>
<p>这表明你的 library 已经被同步至 Jcenter，接下来便可以在其他的 Android 项目里进行远程引用的，需要注意的是在每次 library 更新后，并不会马上被同步至 Jcenter，而是需要等待一段时间。</p>
<h2 id="shan-chu-library-repository">删除 Library/Repository</h2>
<p>当不小心把信息填写错误后，我们可能需要删除错误的仓库和库。删除的方式如下：</p>
<p>进入 Repository/Library 主页，在右上角的 Actions 选择 Edit，然后选择右上角的 Delete 按钮，最后等待删除成功提示即可。</p>

</div>

        </article>
        <nav>
          <a id="avatar-container" href="/">
  <img id="avatar" title="lingyin" src="https://avatars.githubusercontent.com/u/13548822" />
</a>
<p>岁月总是历久弥新，需要细细品尝。</p>
<p>
  欢迎来到<a href="https://github.com/microtears"> lingyin </a>的开发者日志,
  这里是我的一些奇思妙想。
</p>
<p>
  它使用
  <a href="https://www.getzola.org/"> Zola </a>生成。
</p>
<div id="nav-break"></div>
<p id="copyright">© 2019-2025 <a href="/">lingyin</a>.
</p>
        </nav>
      </div>
      <footer>
        
<p id="build-time">Build time: 2025-10-26
</p>
<p id="run-time">Run   time: 0000d 00h 00m 00s</p>



<script>
  function updateTime() {
    const date1 = "2019/07/17 00:00:00";
    const date2 = new Date();
    const date3 = date2.getTime() - new Date(date1).getTime();
    const days = Math.floor(date3 / (24 * 3600 * 1000));
    const leave1 = date3 % (24 * 3600 * 1000);
    const hours = Math.floor(leave1 / (3600 * 1000));
    const leave2 = leave1 % (3600 * 1000);
    const minutes = Math.floor(leave2 / (60 * 1000));
    const leave3 = leave2 % (60 * 1000);
    const seconds = Math.round(leave3 / 1000);
    const element = document.getElementById("run-time");
    element.innerHTML =
      "Run   time: " + days + "d " + hours.toString().padStart(2, '0') + "h " + minutes.toString().padStart(2, '0') + "m " + seconds.toString().padStart(2, '0') + "s";
  }

  setInterval(updateTime, 1000);
</script>
      </footer>
      
    </main>
  </div>
  
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/dart.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/go.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/java.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/kotlin.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/rust.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/shell.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/typescript.min.js"></script>

<script>hljs.highlightAll();</script>



</body>

</html>